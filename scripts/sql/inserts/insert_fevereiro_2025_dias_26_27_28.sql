-- Script para inserir transa√ß√µes de fevereiro 2025 (dias 26, 27, 28)
-- Execute este script no Supabase SQL Editor
-- Insere diretamente na tabela mensal transactions_2025_02
-- NOTA: Lan√ßamentos de META s√£o ignorados conforme instru√ß√£o

-- ==========================================
-- DIA 26 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'HUDSON DANIEL', 'Conta PJ', '2025-02-26', 'HUDSON DANIEL', 44.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RENAN MARINHO', 'Conta PJ', '2025-02-26', 'RENAN MARINHO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RICARDO SANT', 'Conta PJ', '2025-02-26', 'RICARDO SANT', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'MARCELO FERREIRA', 'Conta PJ', '2025-02-26', 'MARCELO FERREIRA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'FELIPE DIAS', 'Conta PJ', '2025-02-26', 'FELIPE DIAS', 39.95, 'income', NOW(), NOW());

-- ==========================================
-- DIA 27 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'NATALIA VIEIRA', 'Conta PJ', '2025-02-27', 'NATALIA VIEIRA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ALTAIR RIBEIRO', 'Conta PJ', '2025-02-27', 'ALTAIR RIBEIRO', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'AD VIVENDO NA PALAVRA', 'Conta PJ', '2025-02-27', 'AD VIVENDO NA PALAVRA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'MARIANO NICOLAS', 'Conta PJ', '2025-02-27', 'MARIANO NICOLAS', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'MARCELO FERREIRA', 'Conta PJ', '2025-02-27', 'MARCELO FERREIRA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'JUNIOR CESAR', 'Conta PJ', '2025-02-27', 'JUNIOR CESAR', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ANDERSON PAULO', 'Conta PJ', '2025-02-27', 'ANDERSON PAULO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RUAN DOS SANTOS', 'Conta PJ', '2025-02-27', 'RUAN DOS SANTOS', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'DONIZETE DA CONCEI√á√ÉO', 'Conta PJ', '2025-02-27', 'DONIZETE DA CONCEI√á√ÉO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'THIAGO DE JESUS', 'Conta PJ', '2025-02-27', 'THIAGO DE JESUS', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'E.N.M TRANSPORTE', 'Conta PJ', '2025-02-27', 'E.N.M TRANSPORTE', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ALEX KOMIYAMA', 'Conta PJ', '2025-02-27', 'ALEX KOMIYAMA', 39.90, 'income', NOW(), NOW());

-- ==========================================
-- DIA 28 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'BRUNO LUIZ', 'Conta PJ', '2025-02-28', 'BRUNO LUIZ', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'PAULO ROGERIO', 'Conta PJ', '2025-02-28', 'PAULO ROGERIO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'NAYARA', 'Conta PJ', '2025-02-28', 'NAYARA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'WILLIAN BACHEGA', 'Conta PJ', '2025-02-28', 'WILLIAN BACHEGA', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'FABIANO MENGONI', 'Conta PJ', '2025-02-28', 'FABIANO MENGONI', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'BRUNO VIEIRA', 'Conta PJ', '2025-02-28', 'BRUNO VIEIRA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'INARAY KAROLINI', 'Conta PJ', '2025-02-28', 'INARAY KAROLINI', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'DIMAS FEITOZA', 'Conta PJ', '2025-02-28', 'DIMAS FEITOZA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'LUCI MARA', 'Conta PJ', '2025-02-28', 'LUCI MARA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'KHERLI MILDHREDTS', 'Conta PJ', '2025-02-28', 'KHERLI MILDHREDTS', 39.95, 'income', NOW(), NOW());

-- ==========================================
-- VERIFICA√á√ïES P√ìS-INSER√á√ÉO
-- ==========================================

-- 1. Verificar inser√ß√£o por dia (dias 26-28)
SELECT 
    'üìä VERIFICA√á√ÉO POR DIA (DIAS 26-28):' as status,
    transaction_date,
    COUNT(*) as total_transacoes,
    SUM(amount) as valor_total,
    ROUND(AVG(amount), 2) as valor_medio
FROM public.transactions_2025_02
WHERE transaction_date BETWEEN '2025-02-26' AND '2025-02-28'
GROUP BY transaction_date
ORDER BY transaction_date;

-- 2. Resumo total dos dias 26-28
SELECT 
    'üéØ RESUMO TOTAL DOS DIAS 26-28:' as status,
    COUNT(*) as total_transacoes,
    SUM(amount) as valor_total,
    MIN(transaction_date) as primeira_data,
    MAX(transaction_date) as ultima_data
FROM public.transactions_2025_02
WHERE transaction_date BETWEEN '2025-02-26' AND '2025-02-28';

-- 3. Comparar com valores esperados
SELECT 
    '‚úÖ VALORES ESPERADOS VS INSERIDOS:' as status,
    'Dia 26: R$ 204,75 esperado' as dia_26,
    'Dia 27: R$ 479,40 esperado' as dia_27,
    'Dia 28: R$ 399,55 esperado' as dia_28;

-- 4. RESUMO FINAL COMPLETO DE FEVEREIRO 2025
SELECT 
    'üéä FEVEREIRO 2025 FINALIZADO:' as status,
    COUNT(*) as total_transacoes_fevereiro,
    SUM(amount) as valor_total_fevereiro,
    COUNT(DISTINCT EXTRACT(DAY FROM transaction_date)) as dias_com_dados,
    ROUND(AVG(amount), 2) as ticket_medio,
    MAX(amount) as maior_transacao,
    MIN(amount) as menor_transacao,
    ROUND(SUM(amount)/COUNT(DISTINCT EXTRACT(DAY FROM transaction_date)), 2) as media_diaria
FROM public.transactions_2025_02
WHERE EXTRACT(YEAR FROM transaction_date) = 2025 
  AND EXTRACT(MONTH FROM transaction_date) = 2;

-- 5. Top transa√ß√µes de todo fevereiro
SELECT 
    'üèÜ TOP 10 TRANSA√á√ïES DE FEVEREIRO 2025:' as status,
    transaction_date,
    client_name,
    amount,
    ROW_NUMBER() OVER (ORDER BY amount DESC) as ranking
FROM public.transactions_2025_02
WHERE EXTRACT(YEAR FROM transaction_date) = 2025 
  AND EXTRACT(MONTH FROM transaction_date) = 2
ORDER BY amount DESC
LIMIT 10;

-- 6. Resumo por dia de todo fevereiro
SELECT 
    'üìÖ RESUMO COMPLETO POR DIA - FEVEREIRO 2025:' as status,
    EXTRACT(DAY FROM transaction_date) as dia,
    COUNT(*) as total_transacoes,
    SUM(amount) as valor_total,
    ROUND(AVG(amount), 2) as ticket_medio_dia
FROM public.transactions_2025_02
WHERE EXTRACT(YEAR FROM transaction_date) = 2025 
  AND EXTRACT(MONTH FROM transaction_date) = 2
GROUP BY EXTRACT(DAY FROM transaction_date)
ORDER BY dia;

-- 7. Verificar se fevereiro est√° 100% completo
SELECT 
    'üîç VERIFICA√á√ÉO DE COMPLETUDE:' as status,
    CASE 
        WHEN COUNT(DISTINCT EXTRACT(DAY FROM transaction_date)) = 28 THEN '‚úÖ FEVEREIRO 100% COMPLETO!'
        ELSE CONCAT('‚ö†Ô∏è FALTAM ', (28 - COUNT(DISTINCT EXTRACT(DAY FROM transaction_date))), ' DIAS')
    END as status_completude,
    COUNT(DISTINCT EXTRACT(DAY FROM transaction_date)) as dias_presentes,
    28 as total_dias_fevereiro
FROM public.transactions_2025_02
WHERE EXTRACT(YEAR FROM transaction_date) = 2025 
  AND EXTRACT(MONTH FROM transaction_date) = 2;

-- 8. Dias ainda faltantes (se houver)
SELECT 
    generate_series(1, 28) as dias_faltantes
EXCEPT
SELECT 
    EXTRACT(DAY FROM transaction_date)::int
FROM public.transactions_2025_02
WHERE EXTRACT(YEAR FROM transaction_date) = 2025 
  AND EXTRACT(MONTH FROM transaction_date) = 2
ORDER BY dias_faltantes;
