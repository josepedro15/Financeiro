-- Script para inserir transações de fevereiro 2025 (dias 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25)
-- Execute este script no Supabase SQL Editor
-- Insere diretamente na tabela mensal transactions_2025_02
-- NOTA: Lançamentos de META são ignorados conforme instrução

-- ==========================================
-- DIA 14 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ALL IN DESIGN', 'Conta PJ', '2025-02-14', 'ALL IN DESIGN', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'VICTOR RAFAEL', 'Conta PJ', '2025-02-14', 'VICTOR RAFAEL', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'LUIS LEITE', 'Conta PJ', '2025-02-14', 'LUIS LEITE', 89.50, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ANDRIGO SILVA', 'Conta PJ', '2025-02-14', 'ANDRIGO SILVA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'WALDO RIBEIRO', 'Conta PJ', '2025-02-14', 'WALDO RIBEIRO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'SERGIO GILIARDO', 'Conta PJ', '2025-02-14', 'SERGIO GILIARDO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'MARLON LOPES', 'Conta PJ', '2025-02-14', 'MARLON LOPES', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RAY RONATAS', 'Conta PJ', '2025-02-14', 'RAY RONATAS', 40.00, 'income', NOW(), NOW());

-- ==========================================
-- DIA 15 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'MARLON LOPES', 'Conta PJ', '2025-02-15', 'MARLON LOPES', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'CARLOS MATEUS', 'Conta PJ', '2025-02-15', 'CARLOS MATEUS', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RICARDO GONÇALVES', 'Conta PJ', '2025-02-15', 'RICARDO GONÇALVES', 39.95, 'income', NOW(), NOW());

-- ==========================================
-- DIA 16 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'GABRIEL CARNEIRO', 'Conta PJ', '2025-02-16', 'GABRIEL CARNEIRO', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'LUIZ CARLOS', 'Conta PJ', '2025-02-16', 'LUIZ CARLOS', 39.95, 'income', NOW(), NOW());

-- ==========================================
-- DIA 17 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RENATA DALLIER', 'Conta PJ', '2025-02-17', 'RENATA DALLIER', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'FRANCISCA EDNEUSA', 'Conta PJ', '2025-02-17', 'FRANCISCA EDNEUSA', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ALEXANDRE DE MORAES', 'Conta PJ', '2025-02-17', 'ALEXANDRE DE MORAES', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'GABRIEL CARNEIRO', 'Conta PJ', '2025-02-17', 'GABRIEL CARNEIRO', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'CARLOS MATEUS', 'Conta PJ', '2025-02-17', 'CARLOS MATEUS', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'WANDERSON SOUZA', 'Conta PJ', '2025-02-17', 'WANDERSON SOUZA', 39.90, 'income', NOW(), NOW());

-- ==========================================
-- DIA 18 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'JORGE RODRIGO', 'Conta PJ', '2025-02-18', 'JORGE RODRIGO', 39.90, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'EMERSON FURTADO', 'Conta PJ', '2025-02-18', 'EMERSON FURTADO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RICARDO GONÇALVES', 'Conta PJ', '2025-02-18', 'RICARDO GONÇALVES', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'IG CONSTRUÇÕES', 'Conta PJ', '2025-02-18', 'IG CONSTRUÇÕES', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'FLAVIO ALEXSANDER', 'Conta PJ', '2025-02-18', 'FLAVIO ALEXSANDER', 39.95, 'income', NOW(), NOW());

-- ==========================================
-- DIA 19 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ALEXANDRE DE MORAES', 'Conta PJ', '2025-02-19', 'ALEXANDRE DE MORAES', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'LUCAS ANTONIO', 'Conta PJ', '2025-02-19', 'LUCAS ANTONIO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'JOSE PAULO', 'Conta PJ', '2025-02-19', 'JOSE PAULO', 39.90, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ABRAAO RODRIGO', 'Conta PJ', '2025-02-19', 'ABRAAO RODRIGO', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'KHERLI MILDHRETS', 'Conta PJ', '2025-02-19', 'KHERLI MILDHRETS', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'FABRICIO ROSSA', 'Conta PJ', '2025-02-19', 'FABRICIO ROSSA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'EMERSON FURTADO', 'Conta PJ', '2025-02-19', 'EMERSON FURTADO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'MATHEUS SILVA', 'Conta PJ', '2025-02-19', 'MATHEUS SILVA', 40.00, 'income', NOW(), NOW());

-- ==========================================
-- DIA 20 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'JOSE ALVES', 'Conta PJ', '2025-02-20', 'JOSE ALVES', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'SUZANE OLIVEIRA', 'Conta PJ', '2025-02-20', 'SUZANE OLIVEIRA', 30.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'WILLIAN', 'Conta PJ', '2025-02-20', 'WILLIAN', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'FABRICIO ROSSA', 'Conta PJ', '2025-02-20', 'FABRICIO ROSSA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'LUCAS ANTONIO', 'Conta PJ', '2025-02-20', 'LUCAS ANTONIO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'JOSE PAULO', 'Conta PJ', '2025-02-20', 'JOSE PAULO', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'JOSE ALVES', 'Conta PJ', '2025-02-20', 'JOSE ALVES', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ABRAAO RODRIGO', 'Conta PJ', '2025-02-20', 'ABRAAO RODRIGO', 39.90, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'EDGAR ALLAN', 'Conta PJ', '2025-02-20', 'EDGAR ALLAN', 40.00, 'income', NOW(), NOW());

-- ==========================================
-- DIA 21 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'WILLIAN CARDOSO', 'Conta PJ', '2025-02-21', 'WILLIAN CARDOSO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'INARAY KAROLINI', 'Conta PJ', '2025-02-21', 'INARAY KAROLINI', 39.95, 'income', NOW(), NOW());

-- ==========================================
-- DIA 22 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'JOANIGO FERNANDO', 'Conta PJ', '2025-02-22', 'JOANIGO FERNANDO', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RAFAEL GUILHERME', 'Conta PJ', '2025-02-22', 'RAFAEL GUILHERME', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'WELLYSON FERREIRA', 'Conta PJ', '2025-02-22', 'WELLYSON FERREIRA', 40.00, 'income', NOW(), NOW());

-- ==========================================
-- DIA 23 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RICARDO VILAR', 'Conta PJ', '2025-02-23', 'RICARDO VILAR', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'BERGSON DE PAULA', 'Conta PJ', '2025-02-23', 'BERGSON DE PAULA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'GABRYEL JOSE', 'Conta PJ', '2025-02-23', 'GABRYEL JOSE', 39.95, 'income', NOW(), NOW());

-- ==========================================
-- DIA 24 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'LUIS LEITE', 'Conta PJ', '2025-02-24', 'LUIS LEITE', 89.50, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'BRUNO VIEIRA', 'Conta PJ', '2025-02-24', 'BRUNO VIEIRA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'LUIZ', 'Conta PJ', '2025-02-24', 'LUIZ', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'DEYVSON FEITOZA', 'Conta PJ', '2025-02-24', 'DEYVSON FEITOZA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RICARDO VILAR', 'Conta PJ', '2025-02-24', 'RICARDO VILAR', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'EDGARD ALLAN', 'Conta PJ', '2025-02-24', 'EDGARD ALLAN', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'JOANIGO FERNANDO', 'Conta PJ', '2025-02-24', 'JOANIGO FERNANDO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'WALDO RIBEIRO', 'Conta PJ', '2025-02-24', 'WALDO RIBEIRO', 79.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'WELLYSON FERREIRA', 'Conta PJ', '2025-02-24', 'WELLYSON FERREIRA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'LUIZ', 'Conta PJ', '2025-02-24', 'LUIZ', 39.95, 'income', NOW(), NOW());

-- ==========================================
-- DIA 25 DE FEVEREIRO 2025
-- ==========================================
INSERT INTO public.transactions_2025_02 (user_id, client_name, account_name, transaction_date, description, amount, transaction_type, created_at, updated_at) VALUES
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'HUDSON DANIEL', 'Conta PJ', '2025-02-25', 'HUDSON DANIEL', 34.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'PIRATA WAURA', 'Conta PJ', '2025-02-25', 'PIRATA WAURA', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ALEX KOMIYAMA', 'Conta PJ', '2025-02-25', 'ALEX KOMIYAMA', 40.00, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'ANDERSON PAULO', 'Conta PJ', '2025-02-25', 'ANDERSON PAULO', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'RICARDO SANT', 'Conta PJ', '2025-02-25', 'RICARDO SANT', 39.95, 'income', NOW(), NOW()),
('2dc520e3-5f19-4dfe-838b-1aca7238ae36', 'GILBERTO ANDRADE', 'Conta PJ', '2025-02-25', 'GILBERTO ANDRADE', 40.00, 'income', NOW(), NOW());

-- ==========================================
-- VERIFICAÇÕES PÓS-INSERÇÃO
-- ==========================================

-- 1. Verificar inserção por dia (dias 14-25)
SELECT 
    '📊 VERIFICAÇÃO POR DIA (DIAS 14-25):' as status,
    transaction_date,
    COUNT(*) as total_transacoes,
    SUM(amount) as valor_total,
    ROUND(AVG(amount), 2) as valor_medio
FROM public.transactions_2025_02
WHERE transaction_date BETWEEN '2025-02-14' AND '2025-02-25'
GROUP BY transaction_date
ORDER BY transaction_date;

-- 2. Resumo total dos dias 14-25
SELECT 
    '🎯 RESUMO TOTAL DOS DIAS 14-25:' as status,
    COUNT(*) as total_transacoes,
    SUM(amount) as valor_total,
    MIN(transaction_date) as primeira_data,
    MAX(transaction_date) as ultima_data
FROM public.transactions_2025_02
WHERE transaction_date BETWEEN '2025-02-14' AND '2025-02-25';

-- 3. Comparar com valores esperados
SELECT 
    '✅ VALORES ESPERADOS VS INSERIDOS:' as status,
    'Dia 14: R$ 369,25 esperado' as dia_14,
    'Dia 15: R$ 119,90 esperado' as dia_15,
    'Dia 16: R$ 79,95 esperado' as dia_16,
    'Dia 17: R$ 239,75 esperado' as dia_17,
    'Dia 18: R$ 199,70 esperado' as dia_18,
    'Dia 19: R$ 319,70 esperado' as dia_19,
    'Dia 20: R$ 349,75 esperado' as dia_20,
    'Dia 21: R$ 79,90 esperado' as dia_21,
    'Dia 22: R$ 119,95 esperado' as dia_22,
    'Dia 23: R$ 119,85 esperado' as dia_23,
    'Dia 24: R$ 489,10 esperado' as dia_24,
    'Dia 25: R$ 234,80 esperado' as dia_25;

-- 4. Top transações dos dias 14-25
SELECT 
    '🏆 MAIORES TRANSAÇÕES (DIAS 14-25):' as status,
    transaction_date,
    client_name,
    amount,
    ROW_NUMBER() OVER (ORDER BY amount DESC) as ranking
FROM public.transactions_2025_02
WHERE transaction_date BETWEEN '2025-02-14' AND '2025-02-25'
ORDER BY amount DESC
LIMIT 10;

-- 5. Destaques especiais dos dias 14-25
SELECT 
    '⭐ DESTAQUES DOS DIAS 14-25:' as status,
    'LUIS LEITE (Dias 14 e 24): R$ 89,50 cada - MAIORES TRANSAÇÕES' as destaque_1,
    'WALDO RIBEIRO (Dia 24): R$ 79,95' as destaque_2,
    'Dia 24: 10 transações = R$ 489,10 - MELHOR DIA' as destaque_3,
    'Dia 20: 9 transações = R$ 349,75 - SEGUNDO MELHOR' as destaque_4;

-- 6. Estado COMPLETO de fevereiro até agora
SELECT 
    '📅 ESTADO COMPLETO DE FEVEREIRO (DIAS 1-25):' as status,
    COUNT(*) as total_transacoes_completo,
    SUM(amount) as valor_total_completo,
    COUNT(DISTINCT EXTRACT(DAY FROM transaction_date)) as dias_com_dados,
    ROUND(AVG(amount), 2) as ticket_medio,
    MAX(amount) as maior_transacao,
    MIN(amount) as menor_transacao
FROM public.transactions_2025_02
WHERE EXTRACT(YEAR FROM transaction_date) = 2025 
  AND EXTRACT(MONTH FROM transaction_date) = 2;

-- 7. Dias faltantes em fevereiro
SELECT 
    generate_series(1, 28) as dia_faltante
EXCEPT
SELECT 
    EXTRACT(DAY FROM transaction_date)::int
FROM public.transactions_2025_02
WHERE EXTRACT(YEAR FROM transaction_date) = 2025 
  AND EXTRACT(MONTH FROM transaction_date) = 2
ORDER BY dia_faltante;
